---
lang: zh-CN
title: Dart语法
description: Dart
---

# Dart

如果你已经搭建好环境：

我们一切学习开始于一个入口方法：不用深究，它就是这样开始的：

```dart
main(){
  print('你好');//结束语句必须要分号
}
/*另一种写法*/
/* viod ：添加void时没有返回值*/ 
void main(){
  print('你好');
}
```

## 变量的两种类型

目标：

- 了解 `弱类型` `强类型`
- 常见 `强类型` 有哪些
- 如何选着何时用那种类型


#### 弱类型

1. var

可以不预先定义变量类型 ，自动会类型推倒（即任何类型）；

```dart
//通过var定义变量
var a;
a = 'ducafecat';
a = 123;
a = true;
a = {'key': 'val123'};
a = ['abc'];

//错误写法
//var a int = 5;报错——var后就不要写类型 ， 写了类型 不要var

```

注意命名规则：

```dart
var str1='2134214';   //正确



var 2str='xxx';  //错误   注意：dart变量标识符开头不能是数字


  
var if='124214'; //错误   注意:标识符不能是保留字和关键字。  


//变量的名字是区分大小写的如: age和Age是不同的变量。在实际的运用中,也建议,不要用一个单词大小写区分两个变量。
var age=20;  

var Age=30;


//标识符(变量名称)一定要见名思意 ：变量名称建议用名词，方法名称建议用动词 

var username="zhangsan";

var price=20;
```

2. Object

动态任意类型，编译阶段检查类型

```dart

Object a = 'aa';
a = 123;
a = [222];
a.p()

```

3. dynamic

动态任意类型，编译阶段不检查检查类型

```dart
dynamic a = '1113';
a = 123;
a = [1111];
a.p();
```

#### 比较 var 与 dynamic、Object

唯一区别 var 如果有初始值，类型被锁定


#### 强类型

声明后，类型被锁定

```dart
String a;
a = 'ducafecat';//正确

a = 123;//报类型错误，因为定义时是String而不是int
```

常见的类型：

|名称|	说明|
|:------:|:------:|
|num	|数字|
|int|	整型|
|double	|浮点|
|bool	|布尔|
|String	|字符串|
|StringBuffer	|字符串 buffer|
|DateTime	|时间日期|
|Duration	|时间区间|
|List	|列表|
|Sets	|无重复队列|
|Maps	|kv 容器|
|enum	|枚举|

```dart
String a = 'CYR';
int i = 123;
double d = 0.12;
bool b = true;
DateTime dt = new DateTime.now();
List l = [ a, i, d, b, dt];
```

#### 默认值

一切都是 Object , 变量声明后默认都是 null

```dart
var a;
String a;
print(a);
assert(a == null);
```

> `assert` 检查点函数，如果不符合条件直接抛出错误并终止程序进程

#### 如何使用

- 在写 API 接口的时候，请用 `强类型`，一旦不符合约定，接收数据时能方便排查故障
- 你在写个小工具时，可以用 `弱类型`，这样代码写起来很快，类型自动适应



## 常量

目标：

- 常量的定义方式
- `final` `const` 的区别

简单来说，所谓常量，就是初始化后永远不改的量

#### 定义

1. 类型声明可以省略

```dart
final String a = 'cyr';
final a = 'cyr';

const String a = 'cyr';
const a = 'cyr';
```

#### 初始后不能再赋值

```dart
final a = 'ducafecat';
a = 'abc';//错误

const a = 'ducafecat';
a = 'abc';//错误
```

#### 不能和 var 同时使用

```dart
final var a = 'ducafecat';
const var a = 'ducafecat';
```

#### const 赋值 申明可省略

```dart
const List ls = const [11, 22, 33];
const List ls = [11, 22, 33];
```

#### 区别

##### 需要确定的值

```dart
final dt = DateTime.now();

const dt = const DateTime.now();
```

- `const`值不变 一开始就得赋值

- `final` 可以开始不赋值 只能赋一次 ; 而`final`不仅有`const`的编译时常量的特性，最重要的它是运行时常量，并且`final`是惰性初始化，即在运行时第一次使用前才初始化;

```dart
const PI=3.14159;
PI=123.1243; //错误的写法 常量不可以修改
print(PI);

final a;//惰性初始化
a = new DateTime.now();   //正确
print(a); //2021-06-30 14:52:55.615161

const a=new DateTime.now();   //错误
```

#### 不可变可传递

```dart
final List ls = [11, 22, 33];
ls[1] = 44;

const List ls = [11, 22, 33];
ls[1] = 44;
```

#### 内存中重复创建

```dart
final a1 = [11 , 22];
final a2 = [11 , 22];
print(identical(a1, a2));//false

const a1 = [11 , 22];
const a2 = [11 , 22];
print(identical(a1, a2));//true
```

## 数值

目标：

- 数值类型 `int`、`double`、`num`
- 数值表示法 十进制、十六进制
- 科学计数法
- 数值转换
- 位运算

#### 数值类型

1. int

整数值，其取值通常位于 -253 和 253 之间。

`建议慢慢再看这个：`[官方：int class](https://api.dart.dev/stable/2.0.0/dart-core/int-class.html)

2. double

64-bit (双精度) 浮点数，符合 IEEE 754 标准。

`建议慢慢再看这个：`[官方：double class](https://api.dart.dev/stable/2.0.0/dart-core/double-class.html)

3. num

int 和 double 都是 num 的子类。

`建议慢慢再看这个：`[官方：num class](https://api.dart.dev/stable/2.0.0/dart-core/num-class.html)


#### 数值表示法 十进制、十六进制

```dart
int a = 1001;
int b = 0xABC;//2748
print([a,b]);
```

#### 科学计数法

```dart
num a = 21.2e3;
print([a]);//[21200.0]
```

#### 数值转换

```dart
//String => int
//String => double
int a = int.parse('123');
double b = double.parse('1.223');

//int => String
//double => String
String a = 123.toString();
String b = 1.223.toString();
print([a, b]);

// double -> int
double a = 1.8;
int b = a.toInt();
print(b);
```

#### 位运算

1. & 与运算

同时 1 才行

```dart
1 0 1 0          10
0 0 1 0          2
--------
0 0 1 0          2


var a = 10;
var b = 2;
print(a & b);//2
```

2. `|`或位运算

有一个 1 就行

```dart
1 0 1 0          10
0 0 1 0          2
--------
1 0 1 0          10

var a = 10;
var b = 2;
print(a | b);
```

可以用在常量组合

```dart
const USE_LEFT = 0x1;
const USE_TOP = 0x2;
const USE_LEFT_TOP = USE_LEFT | USE_TOP;
var result = USE_LEFT | USE_TOP;
print(result);//3
assert(USE_LEFT_TOP == result);
```

3. `~` 非运算

二进制数逐位进行逻辑非运算

```dart
0 1 0 0 1          +9 二进制 最高位 0 整数 1 负数
0 0 1 1 0          补码
1 1 0 0 1          取反
1 1 0 1 0          加1
--------
1 1 0 1 0          -10

var a = 9;
print(~a);
```

4. `^` 异或

不相同的才出 1

```dart
1 0 1 0          10
0 0 1 0          2
--------
1 0 0 0          8

var a = 10;
var b = 2;
print(a ^ b);
```

5. 移位运算符

`<<` 左移

```dart
0 0 0 1          1 二进制
0 0 1 0          左移一位 2
0 1 0 0          左移一位 4
1 0 0 0          左移一位 8

//向左移动一位
var a = 1 << 1;
print(a);
```

6. `>>` 右移

```dart
1 0 0 0          8 二进制
0 1 0 0          右移一位 4
0 0 1 0          右移一位 2
0 0 0 1          右移一位 1
//向右移动一位
var a = 8 >> 1;
print(a);
```

## 布尔

目标：

- 布尔 声明、比较、默认值
- 断言、asset、isEmpty、isNaN
- 逻辑操作符 &&、||、!
- 关系运算符 == != > >= < <=

#### 声明

为了代表布尔值，Dart 有一个名字为 bool 的类型。 只有两个对象是布尔类型的：true 和 false 所创建的对象， 这两个对象也都是编译时常量。

```dart
bool a;
print(a);
```

只有 true 对象才被认为是 true。 所有其他的值都是 flase。

```dart
String name = 'cyr';
if(name) {//此处错误
  print('this is name');
}
```

#### assert 断言

```dart
var a = true;
assert(a);

var name = '';
assert(name.isEmpty);
assert(name.isNotEmpty);

var num = 0 / 0;
assert(num.isNaN);
```
> 注意： 断言只在检查模式下运行有效，如果在生产模式 运行，则断言不会执行。

#### 逻辑运算符

1. `&&` 逻辑与

```dart
bool a = true;
bool b = true;
assert(a && b);
```

2. `||` 逻辑或

```dart
bool a = true;
bool b = false;
assert(a || b);
```

3. `!` 逻辑非

```dart
bool a = true;
bool b = !a;
print(b);
```

#### 关系运算符

1. `==` 等于

```dart
if(a == b) {}
```

2. `!=` 不等于

```dart
if(a != b){}
```

3. `>` 大于

```dart
if(a > b){}
```

4. `>=` 大于或等于

```dart
if(a >= b) {}
```

5. `<` 小于

```dart
if(a < b){}
```

6. `<=` 小于或等于

```dart
if(a <= b){}
```

## 字符串

目标

- 声明方式
- 字符串模板
- 字符串连接
- 转义操作
- 其它常用运算

#### 单引号或者双引号

```dart
String a = 'cyr';
String b = "cyr";
```

#### 字符串模板

```dart
var a = 123;
String b = 'cye : ${a}';
print(b);
```
#### 字符串连接

```dart
var a = 'hello' + ' ' + 'cyr';
var a = 'hello'' ''cyr';
var a = 'hello'   ' '     'cyr';
var a = 'hello'
' '
'cyr';
var a = '''
hello word
this is multi line
''';
var a = """
hello word
this is multi line
""";
print(a);
```

#### 转义符号

```dart
var a = 'hello word \n this is multi line';
print(a);
```

#### 取消转义

```dart
var a = r'hello word \n this is multi line';
print(a);
```

#### 搜索

```dart
var a = 'web site tech';
print(a.contains('ducafecat'));
print(a.startsWith('web'));
print(a.endsWith('tech'));
print(a.indexOf('site'));
```

#### 提取数据

```dart
print(a.substring(0,5));
var b = a.split(' ');
print(b.length);
print(b[0]);
```

#### 大小写转换

```dart
print(a.toLowerCase());//小写
print(a.toUpperCase());//大写
```

#### 裁剪 判断空字符串

```dart
print('    hello word     '.trim());
print(''.isEmpty);
```

#### 替换部分字符

```dart
print('hello word word!'.replaceAll('word', 'ss'));
```

#### 字符串创建

```dart
var sb = StringBuffer();
sb..write('hello word!')
..write('my')
..write(' ')
..writeAll(['web', 'site', 'https://baidu.com']);
print(sb.toString());
```

## 日期和时间

目标：

- 声明
- UTC 时间
- 公元时间
- 时间戳
- 解析标准时间
- 时间运算

#### 声明

```dart
var now = new DateTime.now();
print(now);
var d = new DateTime(2018, 10, 10, 9, 30);
print(d);
```

#### 创建时间 UTC

- [要翻墙：UTC 协调世界时](https://zh.wikipedia.org/wiki/%E5%8D%8F%E8%B0%83%E4%B8%96%E7%95%8C%E6%97%B6)
- [要翻墙：原子时](https://zh.wikipedia.org/wiki/%E5%8E%9F%E5%AD%90%E6%97%B6)
- [要翻墙：原子钟](https://zh.wikipedia.org/wiki/%E5%8E%9F%E5%AD%90%E9%90%98)


#### 解析时间 IOS 8601

- ISO 8601
- 时区
- 时区列表

```dart
var d1 = DateTime.parse('2018-10-10 09:30:30Z');
print(d1);
var d2 = DateTime.parse('2018-10-10 09:30:30+0800');
print(d2);
```

#### 时间增减量

```dart
var d1 = DateTime.now();
print(d1);
print(d1.add(new Duration(minutes: 5)));
print(d1.add(new Duration(minutes: -5)));
```

#### 比较时间

```dart
var d1 = new DateTime(2018, 10, 1);
var d2 = new DateTime(2018, 10, 10);
print(d1.isAfter(d2));//false
print(d1.isBefore(d2));//true
var d1 = DateTime.now();
var d2 = d1.add(new Duration(milliseconds: 30));
print(d1.isAtSameMomentAs(d2));
```

#### 时间差

```dart
var d1 = new DateTime(2018, 10, 1);
var d2 = new DateTime(2018, 10, 10);
var difference = d1.difference(d2);
print([difference.inDays, difference.inHours]);
```

#### 时间戳

```dart
var now = new DateTime.now();
print(now.millisecondsSinceEpoch);
print(now.microsecondsSinceEpoch);
```

## 列表

目标：

- 初始、声明
- 常用属性
- 常用方法

List 是一个有序列表

#### 声明

```dart
List<int> l = [];
l
..add(1)
..add(2)
..add(3);
print(l);
```

#### 属性

|名称|说明|
|:------:|:------:|
|isEmpty|	是否为空|
|isNotEmpty|	是否不为空|
|first|	第一个对象|
|last|	最后一个对象|
|length|	个数|
|reversed|	反转|

```dart
var l = [1, 2, 3];
print(l.first);
print(l.last);
print(l.length);
print(l.isEmpty);
print(l.isNotEmpty);
print(l.reversed);
```

#### 方法

|名称|说明|
|:------:|:------:|
|add	|添加|
|addAll	|添加多个|
|insert|	插入|
|insertAll|	插入多个|
|indexOf|	查询|
|indexWhere|	按条件查询|
|remove|	删除|
|removeAt|	按位置删除|
|fillRange|	按区间填充|
|getRange|	按区间获取|
|shuffle|	随机变换顺序|
|sort|	排序|
|sublist|	创建子|

#### 添加

```dart
List<int> l = [];

l
  ..add(1)
  ..addAll([2, 3, 4, 5])
  ..insert(0, 6)
  ..insertAll(6, [6, 6])
  ;
```

#### 查询

```dart
print(l.indexOf(5));
print(l.indexWhere((it) => it == 4));
```

#### 删除

```dart
l.remove(6);
print(l);
l.removeAt(5);
print(l);
```

#### Range

```dart
l.fillRange(0, 3, 9);
print(l.getRange(0, 5));
```

#### 洗牌

```dart
l.shuffle();
print(l);
l.shuffle();
print(l);
```

#### 排序

```dart
//数字
l.sort();
print(l);
//日期
List<DateTime> dtList = new List();
dtList.addAll([
  DateTime.now(),
  DateTime.now().add(new Duration(days: -12)),
  DateTime.now().add(new Duration(days: -2))
  ]);
print(dtList);
dtList.sort((a, b) => a.compareTo(b));
print(dtList);
```

#### 复制子列表

```dart
print(l);
var l2 = l.sublist(1,4);
print(l2);
```

#### 操作符

|名称	| 说明|
|:----:|:----:|
|+	|连接|
|[]|	取值|
|[]=	|赋值|

```dart
var l1 = [1, 2, 3];
var l2 = [4, 5, 6];
print(l1 + l2);
l1[2] = 9;
print(l1[2]);
```

## Map

目标：

- 初始、声明
- 常用属性
- 常用方法

#### 声明

1. key value 形式的集合

```dart
var a = {'name': 'cc', 'web': 'www.baidu.com'};
```

2. 松散

```dart
var a = new Map();
a['name'] = 'ducafecat';
a['web'] = 'www.ducafecat.tech';
a[0] = 'abc';
```

3. 强类型

```dart
var b = new Map<int, String>();
b[0] = 'java';
b[1] = 'python';
```

#### 基本属性

|名称	| 说明|
|:----:|:----:|
|isEmpty|	是否为空|
|isNotEmpty	|是否不为空|
|keys	key| 集合|
|values|	values 集合|
|length|个数|
|entries|	加工数据入口|

```dart
print(a.isEmpty);
print(a.isNotEmpty);
print(a.keys);
print(a.values);
print(a.length);
print(a.entries);
```

#### 常用方法

|名称	| 说明|
|:----:|:----:|
|addAll|	添加|
|addEntries|	从入口添加|
|containsKey	|按 key 查询|
|containsValue|	按 value 查询|
|clear	|清空|
|remove	|删除某个|
|removeWhere|	按条件删除|
|update|	更新某个|
|updateAll|	按条件更新|

1. addAll

```dart
b.addAll({'first': 'java', 'second': 'python'});
```

2. addEntries

```dart
b.addEntries(a.entries);
```

3. containsKey

```dart
print(a.containsKey('name'));
```

4. clear

```dart
b.clear();
```

5. remove

```dart
a.remove('name');
```

6. removeWhere

```dart
a.removeWhere((key,val) => key == 'name');
```

7. update

```dart
a.update('name', (val) => 'abc');
```

8. updateAll

```dart
a.updateAll((key, val) => "---$val---");
```

#### 操作符

|名称	| 说明|
|:----:|:----:|
|[]	|取值|
|[]=	|赋值|

```dart
print(a['name']);
a['name'] = 'abc';
```

## Set

目标：

- 初始、声明
- 常用属性
- 常用方法